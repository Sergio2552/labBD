USE Cine3
GO

create view EmpleadosVista as select Trabajadores.Nombre, Trabajadores.IDSucursal , Trabajadores.IDTrabajadorfrom Trabajadoresleft join Sucursales  on Trabajadores.Nombre = Sucursales.Nombrecreate view PeliculaSalaVista asselect pel.IDPelicula , pel.Nombre , pel.SinopsisFROM Pelicula pelleft join Salas on pel.Nombre = Salas.Tipo_salacreate view SalasVista asselect sa.*, suc.nombre as 'Nombre_De_sucursal', suc.direccion, suc.telefonofrom Salas saleft join Sucursales suc on sa.IDSucursal = suc.IDSucursalcreate view TrabajadoresVista asselect empl.IDTrabajador, (empl.nombre+empl.apellido) as 'Nombre_Trabajador',empl.edad, suc.IDSucursal,suc.nombre as 'Nombre_de_Sucursal', suc.direccion,suc.telefono, pos.posicionfrom Trabajadores emplleft join Sucursales suc on empl.IDSucursal=suc.IDSucursalleft join Posicion pos on empl.IDPosicion=pos.IDPosicioncreate view CarteleraVista asselect Ca.fecha , Sa.IDSucursal , pe.Nombre , Ca.hora_iniciofrom Cartelera Cajoin Salas Sa on Sa.IDSalas=Ca.ID_Salajoin Pelicula pe on pe.IDPelicula=Sa.IDPeliculawith PeliNoRambo as (select * from Pelicula as pe where nombre <>'Rambo')select pnr.nombre,pnr.sinopsis from PeliNoRambo pnrselect * from Peliculaselect *from CarteleraVista as ca where Nombre = (select Nombre from Pelicula as pel where IDPelicula=1)select *into #CarVisTablefrom CarteleraVistaselect * from #CarVisTable